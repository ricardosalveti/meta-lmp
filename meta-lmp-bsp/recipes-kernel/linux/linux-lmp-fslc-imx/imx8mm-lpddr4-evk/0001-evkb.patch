From 56088a3ad7b85fedfb61274c7d47042ace56a597 Mon Sep 17 00:00:00 2001
From: Ricardo Salveti <ricardo@foundries.io>
Date: Thu, 3 Nov 2022 20:06:43 -0300
Subject: [PATCH] evkb

Signed-off-by: Ricardo Salveti <ricardo@foundries.io>
---
 arch/arm64/boot/dts/freescale/imx8mm-evkb.dts | 24 +++++++++++++++++++
 1 file changed, 24 insertions(+)

diff --git a/arch/arm64/boot/dts/freescale/imx8mm-evkb.dts b/arch/arm64/boot/dts/freescale/imx8mm-evkb.dts
index 86922c4520663..67c58c4b98e94 100755
--- a/arch/arm64/boot/dts/freescale/imx8mm-evkb.dts
+++ b/arch/arm64/boot/dts/freescale/imx8mm-evkb.dts
@@ -44,6 +44,16 @@ opp-750M {
 	};
 };
 
+&uart1 { /* BT */
+	bluetooth {
+		compatible = "brcm,bcm43438-bt";
+		shutdown-gpios = <&gpio2 6 GPIO_ACTIVE_HIGH>;
+		device-wakeup-gpios = <&gpio2 7 GPIO_ACTIVE_HIGH>;
+		host-wakeup-gpios = <&gpio2 8 GPIO_ACTIVE_HIGH>;
+		max-speed = <3000000>;
+	};
+};
+
 &flexspi {
 	pinctrl-names = "default";
 	pinctrl-0 = <&pinctrl_flexspi>;
@@ -66,8 +76,10 @@ &usdhc1 {
 	pinctrl-1 = <&pinctrl_usdhc1_100mhz>, <&pinctrl_wlan>;
 	pinctrl-2 = <&pinctrl_usdhc1_200mhz>, <&pinctrl_wlan>;
 	bus-width = <4>;
+	pm-ignore-notify;
 	keep-power-in-suspend;
 	non-removable;
+	cap-power-off-card;
 	wakeup-source;
 	mmc-pwrseq = <&usdhc1_pwrseq>;
 	fsl,sdio-interrupt-enabled;
@@ -160,4 +172,16 @@ MX8MM_IOMUXC_GPIO1_IO00_ANAMIX_REF_CLK_32K	0x141
 			MX8MM_IOMUXC_SD1_DATA7_GPIO2_IO9		0x159
 		>;
 	};
+
+	pinctrl_uart1: uart1grp {
+		fsl,pins = <
+			MX8MM_IOMUXC_UART1_RXD_UART1_DCE_RX     0x140
+			MX8MM_IOMUXC_UART1_TXD_UART1_DCE_TX     0x140
+			MX8MM_IOMUXC_UART3_RXD_UART1_DCE_CTS_B  0x140
+			MX8MM_IOMUXC_UART3_TXD_UART1_DCE_RTS_B  0x140
+			MX8MM_IOMUXC_SD1_DATA4_GPIO2_IO6        0x19
+			MX8MM_IOMUXC_SD1_DATA5_GPIO2_IO7        0x19
+			MX8MM_IOMUXC_SD1_DATA6_GPIO2_IO8        0x19
+		>;
+	};
 };
-- 
2.38.1

